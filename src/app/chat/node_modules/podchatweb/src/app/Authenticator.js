// app/index.js
import React, {Component, Fragment} from "react";
import {connect} from "react-redux";
import Index from "./../app";
import {auth, retry} from "podauth/src/auth";
import SupportModule from "./SupportModule";

//strings
import {serverConfig} from "../constants/connection";

//actions

//components

//styling

export default class Authenticator extends Component {
  constructor(props) {
    super(props);
    this.state = {
      token: null,
    }
    auth({
      clientId: "88413l69cd4051a039cf115ee4e073",
      scope: "social:write",
      ssoBaseUrl: "https://accounts.pod.ir/oauth2",
      onNewToken: token => this.setState({token})
    });
  }

  render() {
    const {token} = this.state;
    if (!token) {
      return null;
    }
    const props = {
/*      chatSupportAutoShowing: true,
      supportMode: 1435053,*/
      token,
      onRetryHook(e) {
        return retry();
      },
      ...serverConfig()
    }
    return <SupportModule {...props}>
      <Index {...props}/>
    </SupportModule>
  }

}
